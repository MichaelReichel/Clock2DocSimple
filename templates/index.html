<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Clock2Doc - Upload CSV</title>
  <style>
    body { font-family: Arial, sans-serif; max-width: 600px; margin: 40px auto; }
    label { display: block; margin-top: 20px; }
    button { margin-top: 20px; padding: 10px 20px; }
  </style>
</head>
<body>
  <h1>Clock2Doc</h1>
  <form id="csvForm" method="POST" enctype="multipart/form-data" action="/upload">
    <label for="csv_file">Upload your CSV file:</label>
    <input type="file" id="csv_file" name="csv_file" accept=".csv" required>

    <div id="columnSelection" style="display:none;">
      <label for="duration_column">Which column is used for duration?</label>
      <select name="duration_column" id="duration_column" required></select>

      <label for="date_column">Which column is used for date?</label>
      <select name="date_column" id="date_column" required></select>

      <button type="submit">Generate Invoice</button>
    </div>
  </form>

  <script>
    document.getElementById('csv_file').addEventListener('change', function (e) {
      const file = e.target.files[0];
      if (!file) return;

      const reader = new FileReader();
      reader.onload = function (event) {
        const text = event.target.result;
        const lines = text.split("\n");
        const headers = lines[0].split(",").map(h => h.trim().replace(/"/g, ''));

        const durationSelect = document.getElementById("duration_column");
        const dateSelect = document.getElementById("date_column");

        durationSelect.innerHTML = headers.map(h => `<option value="${h}">${h}</option>`).join("");
        dateSelect.innerHTML = headers.map(h => `<option value="${h}">${h}</option>`).join("");

        document.getElementById("columnSelection").style.display = "block";
      };
      reader.readAsText(file);
    });
  </script>
</body>
</html>
